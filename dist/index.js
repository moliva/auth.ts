"use strict";var a=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var h=Object.prototype.hasOwnProperty;var g=(e,o)=>{for(var n in o)a(e,n,{get:o[n],enumerable:!0})},T=(e,o,n,i)=>{if(o&&typeof o=="object"||typeof o=="function")for(let t of m(o))!h.call(e,t)&&t!==n&&a(e,t,{get:()=>o[t],enumerable:!(i=p(o,t))||i.enumerable});return e};var x=e=>T(a({},"__esModule",{value:!0}),e);var A={};g(A,{AUTH_HOST:()=>s,ID_TOKEN_COOKIE:()=>f,authentifiedFetch:()=>l,getCookie:()=>d,handleAuth:()=>w,logout:()=>u,removeCookie:()=>k,setApiHost:()=>C,setCookie:()=>S});module.exports=x(A);function k(e){document.cookie=`${e}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/`}function d(e){let o=e+"=",i=decodeURIComponent(document.cookie).split(";");for(let t=0;t<i.length;t++){let r=i[t];for(;r.charAt(0)==" ";)r=r.substring(1);if(r.indexOf(o)==0)return r.substring(o.length,r.length)}return null}function S(e,o,n){let i="";if(n){let t=new Date;t.setTime(t.getTime()+n*24*60*60*1e3),i=`;expires=${t.toUTCString()}`}document.cookie=`${e}=${o};SameSite=Strict;Secure;path=/${i}`}var f="id_token";function w(e,o){if(!e().identity){let n,i=d(f);if(i!==null){let t=i.split(".")[1],r=atob(t);n=JSON.parse(r)}if(n){let t={identity:n};o({...e(),identity:t})}}}var s;function C(e){s=e}async function u(){await l(`${s}/logout`,{redirect:"manual"})}var c=!1;async function l(e,o={}){if(!s)throw new Error("API_HOST not set");let n={...o,mode:"cors",cache:"no-cache",credentials:"include"},i=await fetch(e,n);if(i.status===401){if(c)for(;c;)await new Promise(t=>setTimeout(t,100));else{c=!0;let t;try{t=await I(n)}catch{}if(!t?.ok)return await u(),location.assign("/"),i;c=!1}return await fetch(e,n)}else return i}async function I(e){return await fetch(`${s}/refresh`,{...e,method:"POST"})}0&&(module.exports={AUTH_HOST,ID_TOKEN_COOKIE,authentifiedFetch,getCookie,handleAuth,logout,removeCookie,setApiHost,setCookie});
