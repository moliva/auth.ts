"use strict";var c=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var h=Object.prototype.hasOwnProperty;var g=(t,o)=>{for(var n in o)c(t,n,{get:o[n],enumerable:!0})},k=(t,o,n,i)=>{if(o&&typeof o=="object"||typeof o=="function")for(let e of m(o))!h.call(t,e)&&e!==n&&c(t,e,{get:()=>o[e],enumerable:!(i=p(o,e))||i.enumerable});return t};var x=t=>k(c({},"__esModule",{value:!0}),t);var I={};g(I,{API_HOST:()=>d,ID_TOKEN_COOKIE:()=>f,authentifiedFetch:()=>l,getCookie:()=>a,handleAuth:()=>w,logout:()=>u,removeCookie:()=>T,setCookie:()=>S});module.exports=x(I);function T(t){document.cookie=`${t}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/`}function a(t){let o=t+"=",i=decodeURIComponent(document.cookie).split(";");for(let e=0;e<i.length;e++){let r=i[e];for(;r.charAt(0)==" ";)r=r.substring(1);if(r.indexOf(o)==0)return r.substring(o.length,r.length)}return null}function S(t,o,n){let i="";if(n){let e=new Date;e.setTime(e.getTime()+n*24*60*60*1e3),i=`;expires=${e.toUTCString()}`}document.cookie=`${t}=${o};SameSite=Strict;Secure;path=/${i}`}var f="id_token";function w(t,o){if(!t().identity){let n,i=a(f);if(i!==null){let e=i.split(".")[1],r=atob(e);n=JSON.parse(r)}if(n){let e={identity:n};o({...t(),identity:e})}}}var d;async function u(){await l(`${d}/logout`)}var s=!1;async function l(t,o={}){let n={...o,mode:"cors",cache:"no-cache",credentials:"include"},i=await fetch(t,n);if(i.status===401){if(s)for(;s;)await new Promise(e=>setTimeout(e,100));else{s=!0;let e;try{e=await C(n)}catch{}if(s=!1,!e?.ok)return await u(),i}return await fetch(t,n)}else return i}async function C(t){return await fetch(`${d}/refresh`,{...t,method:"POST"})}0&&(module.exports={API_HOST,ID_TOKEN_COOKIE,authentifiedFetch,getCookie,handleAuth,logout,removeCookie,setCookie});
