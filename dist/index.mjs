function p(t){document.cookie=`${t}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/`}function c(t){let i=t+"=",o=decodeURIComponent(document.cookie).split(";");for(let e=0;e<o.length;e++){let r=o[e];for(;r.charAt(0)==" ";)r=r.substring(1);if(r.indexOf(i)==0)return r.substring(i.length,r.length)}return null}function m(t,i,n){let o="";if(n){let e=new Date;e.setTime(e.getTime()+n*24*60*60*1e3),o=`;expires=${e.toUTCString()}`}document.cookie=`${t}=${i};SameSite=Strict;Secure;path=/${o}`}var d="id_token";function k(t,i){if(!t().identity){let n,o=c(d);if(o!==null){let e=o.split(".")[1],r=atob(e);n=JSON.parse(r)}if(n){let e={identity:n};i({...t(),identity:e})}}}var a;async function f(){await u(`${a}/logout`)}var s=!1;async function u(t,i={}){let n={...i,mode:"cors",cache:"no-cache",credentials:"include"},o=await fetch(t,n);if(o.status===401){if(s)for(;s;)await new Promise(e=>setTimeout(e,100));else{s=!0;let e;try{e=await l(n)}catch{}if(s=!1,!e?.ok)return await f(),o}return await fetch(t,n)}else return o}async function l(t){return await fetch(`${a}/refresh`,{...t,method:"POST"})}export{a as API_HOST,d as ID_TOKEN_COOKIE,u as authentifiedFetch,c as getCookie,k as handleAuth,f as logout,p as removeCookie,m as setCookie};
